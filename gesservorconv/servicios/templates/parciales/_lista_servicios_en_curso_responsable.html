{% load l10n %}
<div class="table-responsive">
    <table class="table table-striped table-bordered align-middle">
        <thead id="table-head-curso" hx-preserve>
            <tr class="table-primary" id="table-row-curso" hx-preserve>
                <th scope="col" class="col-2 text-center" id="table-col-id-curso" hx-preserve>
                    <i class="fa-solid fa-hashtag" id="hashtag-curso" hx-preserve></i>
                </th>
                <th scope="col" class="col text-center" id="table-col-nombre-curso" hx-preserve>
                    Nombre
                </th>
                <th scope="col" class="col-3 text-center" id="table-col-acciones-curso" hx-preserve>
                    Acciones
                </th>
            </tr>
        </thead>
        <tbody>
            {% widthratio pagina_curso.number|add:"-1" 1 pagina_curso.paginator.per_page as inicio_pagina %}
            {% for servicio in pagina_curso %}
            {% if servicio.convenio is None %}
            <tr>
                <th scope="row" class="text-center">{{ inicio_pagina|add:forloop.counter }}</th>
                <td>
                    {{ servicio.orden_servicio.solicitud_servicio.nombre_solicitud }}
                </td>
                <td class="text-start">
                    <button type="button" class="btn btn-secondary m-1"
                        data-bs-toggle="modal" data-bs-target="#servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                    >
                        <i class="fa-solid fa-circle-info"></i>
                    </button>
                    <a role="button" class="btn btn-primary m-1"
                        href="{% url 'servicios:agregar_progreso' servicio.id_servicio %}"
                    >
                        <i class="fa-solid fa-bars-progress"></i>
                    </a>
                    <div class="modal fade" id="servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                        aria-labelledby="titulo-servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                        aria-hidden="true" tabindex="-1" data-bs-backdrop="static"
                    >
                        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header clearfix">
                                    <h3 class="modal-title fs-5 float-start me-auto"
                                        id="titulo-servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                                    >{{ servicio.orden_servicio.solicitud_servicio.nombre_solicitud }}</h3>
                                    <button type="button" class="btn float-end ms-auto"
                                        data-bs-dismiss="modal" aria-label="Close"
                                    >
                                        <i class="fa-solid fa-xmark fa-xl"></i>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p class="text-center m-0"><b>Descripción</b></p>
                                    <p>{{ servicio.orden_servicio.solicitud_servicio.descripcion_solicitud }}</p>
                                    <p class="text-center m-0"><b>Creación</b></p>
                                    <p id="tiempo-creacion-{{ servicio.id_solicitud }}">
                                        {{ servicio.tiempo_creacion|date:"c" }}
                                    </p>
                                    <p class="text-center m-0"><b>Porcentaje</b></p>
                                    <div class="progress border mb-3" role="progressbar" aria-label="Porcentaje de Progreso"
                                        aria-valuenow="{{ servicio.porcentaje }}" aria-valuemin="0" aria-valuemax="100"
                                    >
                                        <div class="progress-bar text-bg-light progress-bar-striped progress-bar-animated overflow-visible"
                                            style="width: {{ servicio.porcentaje|unlocalize }}%"
                                        >{{ servicio.porcentaje|unlocalize }}</div>
                                    </div>
                                    <p class="text-center m-0"><b>Comitentes</b></p>
                                    <ul class="list-group mb-3">
                                        {% for comitente_en_solicitud in servicio.comitentes_en_solicitud %}
                                        {% if comitente_en_solicitud is not None %}
                                        <li class="list-group-item">{{ comitente_en_solicitud }}</li>
                                        {% endif %}
                                        {% endfor %}
                                    </ul>
                                    <p class="text-center m-0"><b>Responsables Técnicos</b></p>
                                    <ul class="list-group mb-3">
                                        {% for responsable_en_solicitud in servicio.responsables_en_solicitud %}
                                        {% if responsable_en_solicitud is not None %}
                                        <li class="list-group-item">{{ responsable_en_solicitud }}</li>
                                        {% endif %}
                                        {% endfor %}
                                    </ul>
                                </div>
                                <div class="modal-footer">
                                    <input type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal" value="Cerrar"
                                    >
                                    <a class="btn btn-primary"
                                        href="{% url 'servicios:agregar_progreso' servicio.id_servicio %}"
                                    >Agregar progreso</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            {% else %}
            <tr>
                <th scope="row" class="text-center">{{ inicio_pagina|add:forloop.counter }}</th>
                <td>
                    {{ servicio.convenio.solicitud_servicio.nombre_solicitud }}
                </td>
                <td class="text-start">
                    <button type="button" class="btn btn-secondary m-1"
                        data-bs-toggle="modal" data-bs-target="#servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                    >
                        <i class="fa-solid fa-circle-info"></i>
                    </button>
                    <a role="button" class="btn btn-primary m-1"
                        href="{% url 'servicios:agregar_progreso' servicio.id_servicio %}"
                    >
                        <i class="fa-solid fa-bars-progress"></i>
                    </a>
                    <div class="modal fade" id="servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                        aria-labelledby="titulo-servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                        aria-hidden="true" tabindex="-1" data-bs-backdrop="static"
                    >
                        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header clearfix">
                                    <h3 class="modal-title fs-5 float-start me-auto"
                                        id="titulo-servicio-curso{{ inicio_pagina|add:forloop.counter }}"
                                    >{{ servicio.convenio.solicitud_servicio.nombre_solicitud }}</h3>
                                    <button type="button" class="btn float-end ms-auto"
                                        data-bs-dismiss="modal" aria-label="Close"
                                    >
                                        <i class="fa-solid fa-xmark fa-xl"></i>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p class="text-center m-0"><b>Descripción</b></p>
                                    <p>{{ servicio.convenio.solicitud_servicio.descripcion_solicitud }}</p>
                                    <p class="text-center m-0"><b>Creación</b></p>
                                    <p id="tiempo-creacion-{{ servicio.id_solicitud }}">
                                        {{ servicio.tiempo_creacion|date:"c" }}
                                    </p>
                                    <p class="text-center m-0"><b>Porcentaje</b></p>
                                    <div class="progress border mb-3" role="progressbar" aria-label="Porcentaje de Progreso"
                                        aria-valuenow="{{ servicio.porcentaje }}" aria-valuemin="0" aria-valuemax="100"
                                    >
                                        <div class="progress-bar text-bg-light progress-bar-striped progress-bar-animated overflow-visible"
                                            style="width: {{ servicio.porcentaje|unlocalize }}%"
                                        >{{ servicio.porcentaje|unlocalize }}</div>
                                    </div>
                                    <p class="text-center m-0"><b>Comitentes</b></p>
                                    <ul class="list-group mb-3">
                                        {% for comitente_en_solicitud in servicio.comitentes_en_solicitud %}
                                        {% if comitente_en_solicitud is not None %}
                                        <li class="list-group-item">{{ comitente_en_solicitud }}</li>
                                        {% endif %}
                                        {% endfor %}
                                    </ul>
                                    <p class="text-center m-0"><b>Responsables Técnicos</b></p>
                                    <ul class="list-group mb-3">
                                        {% for responsable_en_solicitud in servicio.responsables_en_solicitud %}
                                        {% if responsable_en_solicitud is not None %}
                                        <li class="list-group-item">{{ responsable_en_solicitud }}</li>
                                        {% endif %}
                                        {% endfor %}
                                    </ul>
                                </div>
                                <div class="modal-footer">
                                    <input type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal" value="Cerrar"
                                    >
                                    <a class="btn btn-primary"
                                        href="{% url 'servicios:agregar_progreso' servicio.id_servicio %}"
                                    >Agregar progreso</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            {% endif %}
            {% empty %}
            <tr>
                <td colspan="3" class="text-center">No se encuentra servicios</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div class="clearfix">
    <div class="float-start ms-2">
        <p class="my-2">
            Servicios {{ pagina_curso.start_index }}-{{ pagina_curso.end_index }}
            de {{ pagina_curso.paginator.count }}
        </p>
    </div>
    <div class="float-end me-2">
        <ul class="pagination justify-content-center mb-1">
            {% if pagina_curso.has_previous %}
                <li class="page-item">
                    <input type="button" class="page-link"
                        value="1"
                        hx-get="{% url 'solicitudes:lista_solicitudes_comitente' %}?pagina=1"
                        hx-include="#id_buscar_nombre_curso, #primera-pagina"
                        hx-vals='{"tipo": "curso", "por_pagina": {{ pagina_curso.paginator.per_page }}}'
                        hx-target="#resultados-curso"
                        hx-indicator="#indicador-curso"
                    >
                </li>
                {% if pagina_curso.number > 2 %}
                    {% if pagina_curso.number > 3 %}
                        <li class="page-item disabled">
                            <input type="button" class="page-link" tabindex="-1"
                                aria-disabled="true" value="{{ pagina_curso.paginator.ELLIPSIS }}"
                            >
                        </li>
                    {% endif %}
                    <li class="page-item">
                        <input type="button" class="page-link"
                            value="{{ pagina_curso.previous_page_number }}"
                            hx-get="{% url 'solicitudes:lista_solicitudes_comitente' %}?pagina={{ pagina_curso.previous_page_number }}"
                            hx-include="#id_buscar_nombre_curso, #pagina-anterior"
                            hx-vals='{"tipo": "curso", "por_pagina": {{ pagina_curso.paginator.per_page }}}'
                            hx-target="#resultados-curso"
                            hx-indicator="#indicador-curso"
                        >
                    </li>
                {% endif %}
            {% endif %}
            <li class="page-item active">
                <input type="button" class="page-link"
                    aria-current="page" value="{{ pagina_curso.number }}"
                    hx-get="{% url 'solicitudes:lista_solicitudes_comitente' %}?pagina={{ pagina_curso.number }}"
                    hx-include="#id_buscar_nombre_curso, #pagina-actual"
                    hx-vals='{"tipo": "curso", "por_pagina": {{ pagina_curso.paginator.per_page }}}'
                    hx-target="#resultados-curso"
                    hx-indicator="#indicador-curso"
                >
            </li>
            {% if pagina_curso.has_next %}
                {% if pagina_curso.next_page_number < pagina_curso.paginator.num_pages %}
                    <li class="page-item">
                        <input type="button" class="page-link"
                            value="{{ pagina_curso.next_page_number }}"
                            hx-get="{% url 'solicitudes:lista_solicitudes_comitente' %}?pagina={{ pagina_curso.next_page_number }}"
                            hx-include="#id_buscar_nombre_curso, #pagina-siguiente"
                            hx-vals='{"tipo": "curso", "por_pagina": {{ pagina_curso.paginator.per_page }}}'
                            hx-target="#resultados-curso"
                            hx-indicator="#indicador-curso"
                        >
                    </li>
                    {% if pagina_curso.next_page_number|add:"1" < pagina_curso.paginator.num_pages %}
                        <li class="page-item disabled">
                            <input type="button" class="page-link" tabindex="-1"
                                aria-disabled="true" value="{{ pagina_curso.paginator.ELLIPSIS }}"
                            >
                        </li>
                    {% endif %}
                {% endif %}
                <li class="page-item">
                    <input type="button" class="page-link"
                        value="{{ pagina_curso.paginator.num_pages }}"
                        hx-get="{% url 'solicitudes:lista_solicitudes_comitente' %}?pagina={{ pagina_curso.paginator.num_pages }}"
                        hx-include="#id_buscar_nombre_curso, #ultima-pagina"
                        hx-vals='{"tipo": "curso", "por_pagina": {{ pagina_curso.paginator.per_page }}}'
                        hx-target="#resultados-curso"
                        hx-indicator="#indicador-curso"
                    >
                </li>
            {% endif %}
        </ul>
        <p>
            Página {{ pagina_curso.number }} de {{ pagina_curso.paginator.num_pages }}
        </p>
    </div>
</div>